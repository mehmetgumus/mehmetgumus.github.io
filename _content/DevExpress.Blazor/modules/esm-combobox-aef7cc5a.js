import"./esm-chunk-eaca7b99.js";import{EnsureElement as e,SetPositionOfDropDown as t,AttachEventToElement as o,elementIsInDOM as n,DetachEventFromElement as s}from"./esm-dom-utils-57c82d80.js";import{D as r,R as a}from"./esm-chunk-f7983851.js";import{T as u}from"./esm-chunk-e0d053f7.js";import{K as c}from"./esm-chunk-6d4715b2.js";import{OnOutsideClick as i,IsDropDownVisible as d}from"./esm-dropdowns-871dcdb9.js";import"./esm-chunk-95f069f9.js";import{S as m,H as f,G as l}from"./esm-chunk-94dee8b1.js";import{K as y,a as k}from"./esm-chunk-511b3c8e.js";var p=200,v=p/2;function C(e){var t=K(e);m(t)}function w(t){t=e(t),document.activeElement===t&&b(t)}function h(e,t){e.dataset.timerId&&(clearTimeout(e.dataset.timerId),delete e.dataset.timerId),t||window.setTimeout(function(){h(e,!0)},v)}function b(e){e&&e.dataset.focusedClass&&(e.className=e.dataset.focusedClass)}function T(e,t){return t&&y(e),function(e){return D(e)}(e)&&(e.stopPropagation(),e.preventDefault()),!1}function g(e,t,o,n){var s=!1;if(n&&(s=s||k(e)),s=s||function(e){var t=e.altKey&&(e.keyCode==c.Down||e.keyCode==c.Up),o=D(e),n=e.keyCode==c.Esc||e.keyCode==c.Enter;return t||o||n}(e)){var r=e.target.value;if(o&&f(o)){var a=l(o,!1);t.invokeMethodAsync("OnComboBoxListBoxKeyUp",r,e.keyCode,e.altKey,e.ctrlKey,a.itemHeight,a.scrollTopForRequest,a.scrollHeightForRequest)}else t.invokeMethodAsync("OnComboBoxKeyUp",r,e.keyCode,e.altKey,e.ctrlKey)}}function D(e){return e.keyCode===c.Down||e.keyCode===c.Up||e.keyCode===c.PageUp||e.keyCode===c.PageDown||e.ctrlKey&&(e.keyCode===c.Home||e.keyCode===c.End)}function I(e,t,o){if(t){var n=(new Date).getTime();t.dataset.lastLostFocusTime&&n-t.dataset.lastLostFocusTime<p+100&&!o||(t.dataset.lastLostFocusTime=(new Date).getTime(),e.invokeMethodAsync("OnComboBoxLostFocus",t.value))}}function K(t){return(t=e(t)).querySelector("div.dxbs-dm.dropdown-menu")}function j(c,m,f,l,y){if(c=e(c)){r(c),l="true"===l.toLowerCase(),y="true"===y.toLowerCase(),m=e(m);var k=K(c);t(c,k);var v=k;y&&C(c);var w=function(e){return T(e,l)},D=function(e){return g(e,f,v,l)},j=function(e){return function(e,t){b(e.target)}(e)},E=function(e){return function(e,t){var o=e.target;h(o,!0),o.dataset.timerId=window.setTimeout(function(){if(delete o.dataset.timerId,function(e){e&&e.dataset.bluredClass&&(e.className=e.dataset.bluredClass)}(o),document.activeElement!==o)try{I(t,o)}catch(e){}},p)}(e,f)},x=function(e){return h(m)},F=function(e){return i(e,c,function(){n(c)||r(c);var e=document.activeElement===m,t=m.dataset.timerId>0,o=k&&d(k);h(m),(e||t||o)&&I(f,m,!0)})};return o(m,"keydown",w),o(m,"keyup",D),o(m,"focus",j),o(m,"blur",E),o(c,"mousedown",x),o(document,u.touchMouseDownEventName,F),a(c,function(){s(m,"keydown",w),s(m,"keyup",D),s(m,"focus",j),s(m,"blur",E),s(c,"mousedown",x),s(document,u.touchMouseDownEventName,F)}),Promise.resolve("ok")}}function E(t){if(t=e(t))return r(t),Promise.resolve("ok")}const x={Init:j,Dispose:E,PrepareInputIfFocused:w,ScrollToSelectedItem:C};export default x;export{E as Dispose,j as Init,w as PrepareInputIfFocused,C as ScrollToSelectedItem};
